# Historias Cl√≠nicas üìñ

## Objetivos üìã

Desarrollar un sistema de historias cl√≠nicas para un consultorio que permita la administraci√≥n y gesti√≥n de las mismas.\
Los empleados tendr√°n gesti√≥n sobre pacientes, m√©dicos, empleados, historias cl√≠nicas, episodios, evoluciones, epicrisis, diagn√≥sticos, etc.\
Los pacientes podr√°n realizar consultas acerca de su historia cl√≠nica.\
Utilizar Visual Studio 2019 y crear una aplicaci√≥n utilizando `ASP.NET MVC Core versi√≥n 3.1`.

---------------------------------------

## Enunciado üì¢

La idea principal de este trabajo pr√°ctico, es que ustedes se comporten como un equipo de desarrollo. Este documento, les acerca un equivalente al resultado de una primera entrevista entre el cliente y alguien del equipo que relev√≥ e identific√≥ la informaci√≥n aqu√≠ contenida. A partir de este momento, deber√°n comprender lo que se est√° requiriendo y construir dicha aplicaci√≥n.\
Deben recopilar todas las dudas que tengan y evacuarlas con su nexo (el docente) de cara al cliente. De esta manera, √©l nos ayudar√° a conseguir la informaci√≥n ya un poco m√°s procesada. Es importante destacar que este proceso no debe esperar a ser en clase, sino que debe darse a medida que vayan trabajando en el proyecto. Por otro lado es importante que agrupen sus consultas ya sea por criterios funcionales o t√©cnicos y env√≠en correos con las consultas agrupadas en lugar de enviar cada consulta de forma independiente.

### Consultas

Las consultas que sean realizadas por correo a mailto:federico.marchese@ort.edu.ar deben seguir el siguiente formato:

**Subject:**

- `[NT1-<CURSO LETRA>-GRP-<GRUPO NUMERO>] <Proyecto XXX> | Informativo o Consulta` *ej: [NT1-A-GRP-5] Agenda de Turnos | Consulta*

**Body:**

1. `<xxxxxxxx>` *ej: ¬øLa relaci√≥n del paciente con Turno es 1:1 o 1:N?*
2. `<xxxxxxxx>` *ej: ¬øEst√° bien que encaremos la validaci√≥n del turno activo, con una propiedad booleana en el Turno?*

---------------------------------------

## Proceso de ejecuci√≥n en alto nivel ‚òëÔ∏è

- Crear un proyecto utilizando [visual studio].
- Adicionar todos los modelos dentro de la carpeta Models cada uno en un archivo separado.
- Especificar todas las restricciones y validaciones solicitadas a cada una de las entidades. [DataAnnotations].
- Crear las relaciones entre las entidades.
- Crear una carpeta Data que dentro tendr√° al menos la clase que representar√° el contexto de la base de datos DbContext.
- Crear el DbContext utilizando base de datos sqlite. [DbContext], [Database Sqlite], [Db browser sqlite].
- Agregar los DbSet para cada una de las entidades en el DbContext.
- Crear el Scaffolding para permitir los CRUD de las entidades.
- Aplicar las adecuaciones y validaciones necesarias en los controladores.
- Realizar un sistema de login para los roles identificados en el sistema y un administrador.
- Un administrador podr√° realizar todas tareas que impliquen interacci√≥n del lado del negocio (ABM "Alta-Baja-Modificaci√≥n" de las entidades del sistema y configuraciones en caso de ser necesarias).
- Cada usuario s√≥lo podr√° tomar acci√≥n en el sistema en base al rol que tiene.
- Realizar todos los ajustes necesarios en los modelos y/o funcionalidades.
- Realizar los ajustes requeridos del lado de los permisos.
- Todo lo referido a la presentaci√≥n de la aplicai√≥n (cuestiones visuales).
- Para la visualizaci√≥n se recomienda utilizar [Bootstrap], pero se puede utilizar cualquier herramienta que el grupo considere.

---------------------------------------

## Entidades b√°sicas üìÑ

- Usuario
- Paciente
- M√©dico
- Empleado
- Historia cl√≠nica
- Episodio
- Evoluci√≥n
- Notas
- Epicrisis
- Diagn√≥stico

`Importante: Todas las entidades deben tener su identificador √∫nico Id de tipo Guid.`

`Las propiedades descriptas a continuaci√≥n, son las m√≠nimas que deben tener las entidades, dejando expl√≠cito que ustedes pueden agregar las que consideren necesarias.  
De la misma manera deben definir los tipos de datos asociados a cada una de ellas, como as√≠ tambi√©n las restricciones que apliquen.`

| Entidad | Propiedades |
| ----- | ----- |
| Usuario | Nombre, Email, FechaAlta, Password |
| Paciente | Nombre, Apellido, DNI, Telefono, Direccion, FechaAlta, Email , ObraSocial, HistoriaClinica |
| Medico | Nombre, Apellido, DNI, Telefono, Direccion, FechaAlta, Email, Matricula, Especialidad |
| Empleado | Nombre, Apellido, DNI, Telefono, Direccion, FechaAlta, Email, Legajo |
| HistoriaClinica | Paciente, Episodios |
| Episodio | Motivo, Descripcion, FechaYHoraInicio, FechaYHoraAlta, FechaYHoraCierre, EstadoAbierto, Evoluciones, Epicrisis, EmpleadoRegistra |
| Evolucion | Medico, FechaYHoraInicio, FechaYHoraAlta, FechaYHoraCierre, DescripcionAtencion, EstadoAbierto, Notas |
| Nota | Evolucion, Empleado, Mensaje, FechaYHora |
| Epicrisis | Episodio, Medico, FechaYHora, Diagnostico |
| Diagnostico | Epicrisis, Descripcion, Recomendacion |

**NOTA:** aqu√≠ un link para refrescar el uso de los [Data annotations].

---------------------------------------

## Caracter√≠sticas y Funcionalidades ‚å®Ô∏è

`Todas las entidades deben tener implementado su correspondiente ABM, a menos que sea impl√≠cito el no tener que soportar alguna de estas acciones.`

`IMPORTANTE: Ninguna entidad en el circuito de atenci√≥n m√©dica puede ser modificado o eliminado una vez que se ha creado. Ej. No se puede Eliminar una historia cl√≠nica, no se puede modificar una nota de una evoluci√≥n, etc.`

### Paciente

- Los Pacientes pueden auto registrarse.
  - La autoregistraci√≥n desde el sitio es exclusiva para los pacientes, por lo cual se le asignar√° dicho rol autom√°ticamente.
- Un paciente puede consultar su historia cl√≠nica con todos los detalles que la componen.
- Un paciente puede acceder a los episodios y, por cada episodio, ver las evoluciones con sus detalles.
- Un paciente puede actualizar sus datos de contacto tales como el tel√©fono, direcci√≥n,etc., pero no puede modificar sus datos personales tales como el Dni, nombre, apellido, etc.

### Empleado

- Los empleados deben ser agregados por otro empleado.
  - Al momento del alta del empleado se le definir√° un username y password y se le asignar√° el rol de empleado.
- Un empleado, puede modificar todos los datos de los pacientes.
  - No puede quitar o asociar una nueva historia cl√≠nica a los pacientes.
- El Empleado puede listar todos los pacientes y, por cada uno, ver detalles como las historias cl√≠nicas que tiene asociada y si tiene episodios abiertos.
- El Empleado puede dar de alta pacientes, empleados y m√©dicos, cada uno de ellos con su correspondientes datos requeridos y rol.
- El Empleado puede crear un episodio para un paciente en su historia cl√≠nica con su correspondiente motivo y descripci√≥n, pero s√≥lo se limita a dicha creaci√≥n.

### M√©dico

- Los m√©dicos deben ser agregados por un empleado.
  - Al momento del alta del m√©dico se le definir√° un username y password y se le asignar√° el rol de m√©dico.
- Un m√©dico puede crear evoluciones en Episodios que esten en estado abierto.
  - Para ello buscar√° al paciente, acceder√° a su `historia cl√≠nica -> episodio -> crear la evoluci√≥n`.
- Un m√©dico puede cerrar una evluci√≥n si se han completado todos los campos. El campo de FechaYHoraCierre, se guardar√° autom√°ticamente.
  - Un m√©dico, pueden cargar notas en cada evoluci√≥n seg√∫n sea necesario.
  - Las notas pueden continuar agreg√°ndose luego del cierre de la evoluci√≥n.
- Un m√©dico puede cerrar un episodio, pero para hacer esto, el sistema realizar√° ciertas validaciones.

### Historia cl√≠nica

- La misma se crea autom√°ticamente con la creaci√≥n de un paciente.
  - No se puede eliminar, ni realizar modificaciones posteriores.
  - El detalle interno de la misma es para los m√©dicos y empleados.
  - El paciente propietario de la historia cl√≠nica es el unico paciente que puede ver su historia cl√≠nica.
- Por medio de la historia cl√≠nica se podr√° acceder a la lista de episodios relacionados.

### Episodio

- La creaci√≥n de un episodio en una historia cl√≠nica solamente puede ser realizada por un empleado.
  - El empleado deber√° acceder a un `paciente -> historia cl√≠nica -> crear episodio` e ingresar√°:
    - **Motivo**. *Ej. Traumatismo en pierna Izquierda.*
    - **Descripci√≥n**. *Ej. El paciente se encontraba andando en Skate y sufri√≥ un accidente.*
- El episodio se:
  - Crear√° en estado *Abierto* autom√°ticamente.
  - Con una FechaYHoraInicio tambi√©n de forma autom√°tica.
  - Con un empleado asociado, o sea, el *registrador* de dicho episodio (persona en recepci√≥n que recibe al paciente).
- S√≥lo un m√©dico puede cerrar un Episodio. Para hacer esto, el sistema validar√°:
  1. Que el episodio no tenga ninguna evoluci√≥n en estado *Abierta* o no tenga evoluciones. Si fuese as√≠, deber√° mostrar un mensaje (ver nota debajo para el caso sin evoluciones).
  2. Cargar√° el m√©dico manualmente la FechaYHoraAlta (alta del episodio) del paciente.
  3. Le pedir√° que cargue una epicrisis con su diagn√≥stico y recomendaciones.
      - Una vez finalizado el diagn√≥stico, el episodio pasar√° a estar en estado *Cerrado*.
  4. La FechaYHoraCierre ser√° cargada autom√°ticamente si se cumplen los requerimientos previos.
**Nota**: Si el cierre del episodio es por la condici√≥n `sin evoluciones`, se generar√° un "Cierre Administrativo" en el cual, el sistema cargar√° una epicrisis, con alguna informaci√≥n que el empleado ingresar√° para dejar registro de que fue un cierre administrativo. *Ej. El paciente realiz√≥ el ingreso y antes de ser atendido, se fu√©.*

### Evoluci√≥n

- Una evoluci√≥n solo la puede crear y gestionar un m√©dico.
  - La √∫nica excepci√≥n es que un empleado puede cargar notas en evoluciones por cuestiones administrativas. *Ej. Salvo que el alta del paciente en la evoluci√≥n es 10/08/2020*
- Informaci√≥n que se cargar√° autom√°ticamente en las evoluciones:
  - En el alta de una evoluci√≥n:
    - El m√©dico que la est√° creando.
    - La fecha y hora de inicio de la evoluci√≥n.
    - El estado *Abierto*.
  - En el cierre de una evoluci√≥n:
    - La fecha y hora de cierre de la evoluci√≥n.
- Informaci√≥n que se cargar√° manualmente en las evoluciones:
  - La fecha y hora de alta de la evoluci√≥n.
  - La descripci√≥n.
  - Las notas (Las que sean necesarias).
- Para cerrar una evoluci√≥n:
  - Todos los datos manuales requeridos deben estar completos
  - S√≥lo lo puede hacer un m√©dico.

### Nota

- Las notas se crean a partir de una evoluci√≥n.
- A trav√©s de las notas pueden cargar un mensaje cualquier empleado o m√©dico.
- Quedar√° autom√°ticmente registrado el autor de la nota y la fecha y hora de carga.

### Epicrisis

- La epicrisis pertene a un episodio.
  - S√≥lo puede haber una epicrisis por episodio.
  - Para poder crearla todas las evoluciones deben estar cerradas.
  - El episodio debe estar abierto y cargar la epicrisis, de estar todo correcto, se debe cerrar autom√°ticamente.
  - La epicrisis s√≥lo puede ser cargada por un m√©dico.
  - La excepci√≥n es la creaci√≥n autom√°tica, si cierra un empleado, por proceso administrativo (recordar que un empleado puede cerrar un episodio sin evoluciones).
  - La fecha y hora se carga autom√°ticamente.
  - El diagn√≥stico se carga manualmente.

### Diagn√≥stico

- Pertenece a una epicrisis.
- Se cargar√° una descripci√≥n y una recomendaci√≥n de forma manual.

### Aplicaci√≥n General

- Informaci√≥n institucional.
- Se deben listar el cuerpo m√©dico junto con sus especialidades.
- Los accesos a las funcionalidades y/o capacidades, debe estar basada en los roles que tenga cada individuo.

[//]: # (referencias externas)
   [visual studio]: <https://visualstudio.microsoft.com/en/vs/>
   [Data annotations]: <https://www.c-sharpcorner.com/UploadFile/af66b7/data-annotations-for-mvc/>
   [Bootstrap]: <https://getbootstrap.com/>
   [DbContext]: <https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontext?view=efcore-3.1>
   [Database Sqlite]: <https://docs.microsoft.com/en-us/ef/core/providers/sqlite/?tabs=dotnet-core-cli>
   [Db browser sqlite]: <https://sqlitebrowser.org/>
   [DataAnnotations]: <https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.dataannotations?view=netcore-3.1>
